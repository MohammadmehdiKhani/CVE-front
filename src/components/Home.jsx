import React, { useState, useEffect } from "react";
import SearchBox from "./SearchBox";
import "../style/home.css";
import ProgramTable from "./ProgramsTable";
import http from "../services/httpService.js";

function Home() {
  const [programs, setPrograms] = useState([]);

  useEffect(() => {
    async function fetchData() {
      const response = await http.get("http://localhost:3001/programs", {
        headers: { "x-auth-token": localStorage.getItem("token") },
      });
      console.log(response.data.programs);
      setPrograms(response.data.programs);
    }
    fetchData();
  }, []);

  const handleDeleteItem = async (item) => {
    console.log("delete " + item.name);

    await http.delete("endpoint" + "/" + item.id);
    const newPrograms = programs.filter((p) => p.id !== item.id);
    setPrograms(newPrograms);
  };

  return (
    <div className="HomePage-container">
      <SearchBox options={["one", "two", "three"]}></SearchBox>

      <div className="mt-5 farsi-bold">جدول برنامه‌ها</div>
      <ProgramTable
        handleDeleteItem={handleDeleteItem}
        items={programs}
      ></ProgramTable>
    </div>
  );
}

export default Home;
